(()=>{"use strict";var e={582:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Player=t.Rock=t.GameObject=void 0;const i=s(419),n=s(652),o=s(512);class h{position;dimensions;velocity;acceleration;onground;maxSpeed;mass;id;sprite;gravity;constructor(e,t,s,i,o,h,r){this.position=e,this.dimensions=t,this.velocity=n.Vec2.zeroVector,this.acceleration=n.Vec2.zeroVector,this.onground=!1,this.maxSpeed=s,this.mass=h,this.gravity=r,this.id=i,this.sprite=o,this.init()}applyForce(e){e.x/=this.mass,e.y/=this.mass,this.acceleration.add(e)}update(e){this.velocity.x+=this.acceleration.x,this.velocity.y+=this.acceleration.y,this.velocity.x>this.maxSpeed&&(this.velocity.x=this.maxSpeed),this.velocity.x<-this.maxSpeed&&(this.velocity.x=-this.maxSpeed),this.position.x+=this.velocity.x*e,this.position.y+=this.velocity.y*e,0==this.acceleration.x&&(this.velocity.x*=.9),0==this.acceleration.y&&(this.velocity.y*=.9),this.acceleration=n.Vec2.zeroVector,this.onground=!1,this.applyForce(new n.Vec2(0,this.gravity)),this.tick()}render(){i.renderer.translateRelative(this.position),i.renderer.drawSprite(this.sprite,0,0,this.dimensions.x,this.dimensions.y),i.renderer.translateRelative(new n.Vec2(0,0))}}t.GameObject=h,t.Rock=class extends h{constructor(e,t,s){super(e,new n.Vec2(t,t),10,"rock",s,t,9.81)}init(){this.velocity=new n.Vec2(Math.round(10*Math.random()-5),0)}tick(){let e=o.level.getCollidingLines(this);for(let t=0,s=e.length;t<s;t++){for(;e[t].intersectsAABB(this);)this.position.y-=.5;this.onground=!0,this.velocity.y=0}}},t.Player=class extends h{alive;speed;constructor(e,t,s){super(e,t,10,"player",s,10,9.81),this.alive=!0,this.speed=2}init(){}tick(){let e=o.level.getCollidingLines(this);for(let t=0,s=e.length;t<s;t++){for(;e[t].intersectsAABB(this);)this.position.y-=.5;this.onground=!0,this.velocity.y=0}}move(e){switch(e){case 0:this.acceleration.x=-this.speed;break;case 1:this.acceleration.x=this.speed;break;case 2:this.onground&&(this.acceleration.y=-20)}}}},18:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.entityManager=void 0;const s=new class{entities;constructor(){this.entities=[]}getEntity(e){for(let t of this.entities)if(t.id==e)return t;return null}newEntity(e){this.entities.includes(e)||this.entities.push(e)}removeEntity(e){this.entities.includes(e)&&this.entities.splice(this.entities.indexOf(e),1)}update(e){this.entities.forEach((t=>{t.update(e)}))}render(){this.entities.forEach((e=>{e.render()}))}};t.entityManager=s},652:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Mesh=t.Line=t.Vec2=void 0;class s{x;y;constructor(e,t){this.x=e,this.y=t}add(e){this.x+=e.x,this.y+=e.y}sub(e){this.x-=e.x,this.y-=e.y}mult(e){this.x*=e.x,this.y*=e.y}div(e){this.x/=e.x,this.y/=e.y}static get zeroVector(){return new s(0,0)}static get down(){return new s(0,1)}static get up(){return new s(0,-1)}static get left(){return new s(-1,0)}static get right(){return new s(1,0)}}t.Vec2=s;class i{a;b;surfaceNormal;constructor(e,t){this.a=e,this.b=t;let i={x:this.b.x-this.a.x,y:this.b.y-this.a.y},n=Math.sqrt(Math.pow(i.x,2)+Math.pow(i.y,2));i.x/=n,i.y/=n,this.surfaceNormal=new s(i.y,-i.x)}intersectsLine(e){let t,i,n,o,h,r,c,a;t=this.a.x,i=this.a.y,n=this.b.x,o=this.b.y,h=e.a.x,r=e.a.y,c=e.b.x,a=e.b.y;let l=(t-n)*(r-a)-(i-o)*(h-c);if(0==l)return;let d=((t-h)*(r-a)-(i-r)*(h-c))/l,u=((t-h)*(i-o)-(i-r)*(t-n))/l;return d>=0&&d<=1&&u>=0&&u<=1?new s(t+d*(n-t),i+d*(o-i)):void 0}intersectsAABB(e){let t,n,o,h,r,c,a,l,d,u,f,y;return t=e.position.x,r=e.position.y,n=e.position.x+e.dimensions.x,c=e.position.y,o=e.position.x+e.dimensions.x,a=e.position.y+e.dimensions.y,h=e.position.x,l=e.position.y+e.dimensions.y,d=new i(new s(t,r),new s(n,c)),u=new i(new s(n,c),new s(o,a)),f=new i(new s(o,a),new s(h,l)),y=new i(new s(h,l),new s(t,r)),null!=this.intersectsLine(d)||null!=this.intersectsLine(u)||null!=this.intersectsLine(f)||null!=this.intersectsLine(y)}}t.Line=i;class n{mesh;constructor(e){this.mesh=[];for(let t=1,n=e.length;t<n;t++)this.mesh.push(new i(new s(e[t-1].x,e[t-1].y),new s(e[t].x,e[t].y)));this.mesh.push(new i(new s(e[e.length-1].x,e[e.length-1].y),new s(e[0].x,e[0].y)))}static meshFromAABB(e){let t,i,o,h,r,c,a,l;return t=e.position.x,r=e.position.y,i=e.position.x+e.dimensions.x,c=e.position.y,o=e.position.x+e.dimensions.x,a=e.position.y+e.dimensions.y,h=e.position.x,l=e.position.y+e.dimensions.y,new n([new s(t,r),new s(i,c),new s(o,a),new s(h,l)])}getMesh(){return this.mesh}}t.Mesh=n},717:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InputHandler=void 0,t.InputHandler=class{keys;keyBinds;constructor(e){this.keys=[],this.keyBinds=e,addEventListener("keydown",this.keyPressed.bind(this)),addEventListener("keyup",this.keyReleased.bind(this))}keyPressed(e){this.keys.includes(e.key)||this.keys.push(e.key)}keyReleased(e){try{this.keys.splice(this.keys.indexOf(e.key),1)}catch(e){}}releaseAllkeys(){this.keys=[]}handleKeys(){for(let e of this.keys)try{this.keyBinds[e]()}catch(e){}}}},512:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.level=void 0;const i=s(419),n=s(423),o=s(652);class h{mesh;config;xPosition;constructor(e,t,s){this.xPosition=s,this.config=t,this.mesh=this.makeLayout(e)}makeLayout(e){let t=[];for(let s=0,i=this.config.maxChunkSegments;s<=i;s++){let i,n,h,r;i=s*this.config.segmentLength+this.xPosition,h=e.noise2D(i/this.config.noiseSampleSize,0),r=0;for(let t=1;t<3;t++)h+=e.noise2D(i/this.config.noiseSampleSize*t,0)/Math.pow(2,t),r+=1/Math.pow(2,t);h/=1+r,h=h*this.config.maxLevelHeight/2,n=h,t.push(new o.Vec2(i,n))}return t.push(new o.Vec2(this.xPosition+this.config.maxChunkSegments*this.config.segmentLength,this.config.levelDownExtension)),t.push(new o.Vec2(this.xPosition,this.config.levelDownExtension)),new o.Mesh(t)}}t.level=new class{config;chunks;noiseInstance;constructor(e){this.config=e,this.chunks=[],this.noiseInstance=new n.default,this.generateChunks()}checkPlayerCamera(e){let t,s,n,h;if(h=this.chunks[0].xPosition,t=e.position.x,s=t-i.renderer.center.x-h,n=this.chunks[this.chunks.length-1].xPosition+this.config.maxChunkSegments*this.config.segmentLength-t-i.renderer.center.x,s>0?i.renderer.camera.moveTo(e.position):i.renderer.camera.moveTo(new o.Vec2(h+i.renderer.center.x,e.position.y)),e.position.x<=h&&(e.position.x=h),n<0){let e=this.chunks.shift();e.xPosition=this.chunks[this.chunks.length-1].xPosition+this.config.maxChunkSegments*this.config.segmentLength,e.mesh=e.makeLayout(this.noiseInstance),console.log(e.xPosition),this.chunks.push(e)}}generateChunks(){let e=-this.config.maxChunkSegments*this.config.segmentLength-i.renderer.center.x;for(;!(e>i.renderer.width+this.config.maxChunkSegments*this.config.segmentLength+this.config.renderDistance);)this.chunks.push(new h(this.noiseInstance,this.config,e)),e+=this.config.maxChunkSegments*this.config.segmentLength}renderLevel(){i.renderer.translateRelative(o.Vec2.zeroVector),this.chunks.forEach((e=>{i.renderer.color("green"),i.renderer.fillLineMesh(e.mesh.getMesh())}))}getChunkAt(e){let t=this;return 0==e&&(e+=1),function s(i,n,o){let h=Math.floor((n+o)/2),r=i[h];if(!r)return;let c=r.xPosition,a=r.xPosition+t.config.segmentLength*t.config.maxChunkSegments;return e>=c&&e<=a?r:e>c?s(i,h+1,o):s(i,n,h-1)}(this.chunks,0,this.chunks.length)}getCollidingLines(e){let s=[],i=[];return s.push(t.level.getChunkAt(e.position.x)),s.push(t.level.getChunkAt(e.position.x+e.dimensions.x)),s.forEach((t=>{t?.mesh.getMesh().forEach((t=>{t.intersectsAABB(e)&&i.push(t)}))})),i}}({segmentLength:10,maxLevelHeight:700,noiseSampleSize:2e3,renderDistance:500,maxChunkSegments:50,levelDownExtension:1500})},419:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.renderer=t.loadImages=void 0;const i=s(652);t.loadImages=async function(e,t){let s={};for(let i=0,n=e.length;i<n;i++){let n=e[i],o=await new Promise((e=>{let s=new Image;s.src=`${t}/${n}.png`,s.onload=()=>e(s),s.onerror=()=>{throw new Error("Image not found")}}));s[n]=o}return s},t.renderer=new class{canvas;context;width;height;offset;center;camera;constructor(e,t,s,n){this.canvas=n?document.getElementById(n):document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=e,this.height=t,this.canvas.width=e,this.canvas.height=t,this.offset=i.Vec2.zeroVector,this.center=new i.Vec2(this.width/2,this.height/2),this.camera=s}clear(){this.context.clearRect(0,0,this.width,this.height)}color(e){this.context.fillStyle=e}drawRectangle(e,t,s,i){e=Math.round(e+this.offset.x),t=Math.round(t+this.offset.y),this.context.fillRect(e,t,s,i)}drawLineMesh(e){this.context.lineWidth=1,this.context.beginPath();let t=e[0];this.context.moveTo(Math.round(t.a.x+this.offset.x),Math.round(t.a.y+this.offset.y)),this.context.lineTo(Math.round(t.b.x+this.offset.x),Math.round(t.b.y+this.offset.y));for(let t=1,s=e.length;t<s;t++){let s=e[t];this.context.lineTo(Math.round(s.b.x+this.offset.x),Math.round(s.b.y+this.offset.y))}this.context.closePath(),this.context.stroke()}fillLineMesh(e){this.context.beginPath();let t=e[0];this.context.moveTo(Math.round(t.a.x+this.offset.x),Math.round(t.a.y+this.offset.y)),this.context.lineTo(Math.round(t.b.x+this.offset.x),Math.round(t.b.y+this.offset.y));for(let t=1,s=e.length;t<s;t++){let s=e[t];this.context.lineTo(Math.round(s.b.x+this.offset.x),Math.round(s.b.y+this.offset.y))}this.context.closePath(),this.context.fill()}drawSprite(e,t,s,i=e.width,n=e.height){t=Math.round(t+this.offset.x),s=Math.round(s+this.offset.y),this.context.drawImage(e,t,s,i,n)}drawLine(e,t,s,i,n){e=Math.round(e+this.offset.x),t=Math.round(t+this.offset.y),s=Math.round(s+this.offset.x),i=Math.round(i+this.offset.y),this.context.lineWidth=n,this.context.beginPath(),this.context.moveTo(e,t),this.context.lineTo(s,i),this.context.stroke(),this.context.closePath()}drawShape(e){let t=e[0];this.context.lineWidth=1,this.context.beginPath(),this.context.moveTo(Math.round(t.x+this.offset.x),Math.round(t.y+this.offset.y));for(let t=1,s=e.length;t<s;t++){let s=e[t];this.context.lineTo(Math.round(s.x+this.offset.x),Math.round(s.y+this.offset.y))}this.context.closePath(),this.context.stroke()}fillShape(e){let t=e[0];this.context.beginPath(),this.context.moveTo(Math.round(t.x+this.offset.x),Math.round(t.y+this.offset.y));for(let t=1,s=e.length;t<s;t++){let s=e[t];this.context.lineTo(Math.round(s.x+this.offset.x),Math.round(s.y+this.offset.y))}this.context.closePath(),this.context.fill()}translateRelative(e){this.offset.x=e.x+this.camera.position.x+this.center.x,this.offset.y=e.y+this.camera.position.y+this.center.y}translateToScreenCoordinates(e){this.offset.x=e.x,this.offset.y=e.y}getCanvas(){return this.canvas}}(screen.width,screen.height,new class{position;constructor(e){this.position=e}moveTo(e){this.position.x=-e.x,this.position.y=-e.y}}(i.Vec2.zeroVector),"gameScreen")},423:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildPermutationTable=t.SimplexNoise=void 0;const s=.5*(Math.sqrt(3)-1),i=(3-Math.sqrt(3))/6,n=1/6,o=(Math.sqrt(5)-1)/4,h=(5-Math.sqrt(5))/20,r=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),c=new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]);class a{p;perm;permMod12;constructor(e=Math.random){const t="function"==typeof e?e:function(e){let t=0,s=0,i=0,n=1;const o=function(){let e=4022871197;return function(t){t=t.toString();for(let s=0;s<t.length;s++){e+=t.charCodeAt(s);let i=.02519603282416938*e;e=i>>>0,i-=e,i*=e,e=i>>>0,i-=e,e+=4294967296*i}return 2.3283064365386963e-10*(e>>>0)}}();return t=o(" "),s=o(" "),i=o(" "),t-=o(e),t<0&&(t+=1),s-=o(e),s<0&&(s+=1),i-=o(e),i<0&&(i+=1),function(){const e=2091639*t+2.3283064365386963e-10*n;return t=s,s=i,i=e-(n=0|e)}}(e);this.p=l(t),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(let e=0;e<512;e++)this.perm[e]=this.p[255&e],this.permMod12[e]=this.perm[e]%12}noise2D(e,t){const n=this.permMod12,o=this.perm;let h=0,c=0,a=0;const l=(e+t)*s,d=Math.floor(e+l),u=Math.floor(t+l),f=(d+u)*i,y=e-(d-f),x=t-(u-f);let g,m;y>x?(g=1,m=0):(g=0,m=1);const p=y-g+i,w=x-m+i,v=y-1+2*i,M=x-1+2*i,k=255&d,b=255&u;let P=.5-y*y-x*x;if(P>=0){const e=3*n[k+o[b]];P*=P,h=P*P*(r[e]*y+r[e+1]*x)}let L=.5-p*p-w*w;if(L>=0){const e=3*n[k+g+o[b+m]];L*=L,c=L*L*(r[e]*p+r[e+1]*w)}let S=.5-v*v-M*M;if(S>=0){const e=3*n[k+1+o[b+1]];S*=S,a=S*S*(r[e]*v+r[e+1]*M)}return 70*(h+c+a)}noise3D(e,t,s){const i=this.permMod12,o=this.perm;let h,c,a,l;const d=.3333333333333333*(e+t+s),u=Math.floor(e+d),f=Math.floor(t+d),y=Math.floor(s+d),x=(u+f+y)*n,g=e-(u-x),m=t-(f-x),p=s-(y-x);let w,v,M,k,b,P;g>=m?m>=p?(w=1,v=0,M=0,k=1,b=1,P=0):g>=p?(w=1,v=0,M=0,k=1,b=0,P=1):(w=0,v=0,M=1,k=1,b=0,P=1):m<p?(w=0,v=0,M=1,k=0,b=1,P=1):g<p?(w=0,v=1,M=0,k=0,b=1,P=1):(w=0,v=1,M=0,k=1,b=1,P=0);const L=g-w+n,S=m-v+n,V=p-M+n,C=g-k+2*n,A=m-b+2*n,E=p-P+2*n,T=g-1+.5,B=m-1+.5,I=p-1+.5,D=255&u,_=255&f,R=255&y;let z=.6-g*g-m*m-p*p;if(z<0)h=0;else{const e=3*i[D+o[_+o[R]]];z*=z,h=z*z*(r[e]*g+r[e+1]*m+r[e+2]*p)}let O=.6-L*L-S*S-V*V;if(O<0)c=0;else{const e=3*i[D+w+o[_+v+o[R+M]]];O*=O,c=O*O*(r[e]*L+r[e+1]*S+r[e+2]*V)}let j=.6-C*C-A*A-E*E;if(j<0)a=0;else{const e=3*i[D+k+o[_+b+o[R+P]]];j*=j,a=j*j*(r[e]*C+r[e+1]*A+r[e+2]*E)}let q=.6-T*T-B*B-I*I;if(q<0)l=0;else{const e=3*i[D+1+o[_+1+o[R+1]]];q*=q,l=q*q*(r[e]*T+r[e+1]*B+r[e+2]*I)}return 32*(h+c+a+l)}noise4D(e,t,s,i){const n=this.perm;let r,a,l,d,u;const f=(e+t+s+i)*o,y=Math.floor(e+f),x=Math.floor(t+f),g=Math.floor(s+f),m=Math.floor(i+f),p=(y+x+g+m)*h,w=e-(y-p),v=t-(x-p),M=s-(g-p),k=i-(m-p);let b=0,P=0,L=0,S=0;w>v?b++:P++,w>M?b++:L++,w>k?b++:S++,v>M?P++:L++,v>k?P++:S++,M>k?L++:S++;const V=b>=3?1:0,C=P>=3?1:0,A=L>=3?1:0,E=S>=3?1:0,T=b>=2?1:0,B=P>=2?1:0,I=L>=2?1:0,D=S>=2?1:0,_=b>=1?1:0,R=P>=1?1:0,z=L>=1?1:0,O=S>=1?1:0,j=w-V+h,q=v-C+h,F=M-A+h,H=k-E+h,N=w-T+2*h,U=v-B+2*h,W=M-I+2*h,G=k-D+2*h,K=w-_+3*h,$=v-R+3*h,J=M-z+3*h,Q=k-O+3*h,X=w-1+4*h,Y=v-1+4*h,Z=M-1+4*h,ee=k-1+4*h,te=255&y,se=255&x,ie=255&g,ne=255&m;let oe=.6-w*w-v*v-M*M-k*k;if(oe<0)r=0;else{const e=n[te+n[se+n[ie+n[ne]]]]%32*4;oe*=oe,r=oe*oe*(c[e]*w+c[e+1]*v+c[e+2]*M+c[e+3]*k)}let he=.6-j*j-q*q-F*F-H*H;if(he<0)a=0;else{const e=n[te+V+n[se+C+n[ie+A+n[ne+E]]]]%32*4;he*=he,a=he*he*(c[e]*j+c[e+1]*q+c[e+2]*F+c[e+3]*H)}let re=.6-N*N-U*U-W*W-G*G;if(re<0)l=0;else{const e=n[te+T+n[se+B+n[ie+I+n[ne+D]]]]%32*4;re*=re,l=re*re*(c[e]*N+c[e+1]*U+c[e+2]*W+c[e+3]*G)}let ce=.6-K*K-$*$-J*J-Q*Q;if(ce<0)d=0;else{const e=n[te+_+n[se+R+n[ie+z+n[ne+O]]]]%32*4;ce*=ce,d=ce*ce*(c[e]*K+c[e+1]*$+c[e+2]*J+c[e+3]*Q)}let ae=.6-X*X-Y*Y-Z*Z-ee*ee;if(ae<0)u=0;else{const e=n[te+1+n[se+1+n[ie+1+n[ne+1]]]]%32*4;ae*=ae,u=ae*ae*(c[e]*X+c[e+1]*Y+c[e+2]*Z+c[e+3]*ee)}return 27*(r+a+l+d+u)}}function l(e){const t=new Uint8Array(256);for(let e=0;e<256;e++)t[e]=e;for(let s=0;s<255;s++){const i=s+~~(e()*(256-s)),n=t[s];t[s]=t[i],t[i]=n}return t}t.SimplexNoise=a,t.default=a,t.buildPermutationTable=l}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,s),o.exports}(()=>{const e=s(419),t=s(717),i=s(18),n=s(582),o=s(512),h=s(652);let r,c,a,l,d,u=!0;const f=1e3/60;let y,x,g;function m(){let t=Date.now();x=(t-y)/f,g+=t-y,y=t,r.handleKeys(),i.entityManager.update(x),o.level.checkPlayerCamera(c),g>f&&(e.renderer.clear(),e.renderer.translateToScreenCoordinates(h.Vec2.zeroVector),e.renderer.drawSprite(a.Background1,0,0,e.renderer.width,e.renderer.height),o.level.renderLevel(),i.entityManager.render(),g=0),u&&requestAnimationFrame(m)}onload=async function(){a=await(0,e.loadImages)(["Background1","rock1","player"],"./src/assets"),c=new n.Player(new h.Vec2(0,-300),new h.Vec2(50,100),a.player),i.entityManager.newEntity(c),i.entityManager.newEntity(new n.Rock(new h.Vec2(0,-500),200,a.rock1)),r=new t.InputHandler({a:()=>c.move(0),d:()=>c.move(1)," ":()=>c.move(2),r:()=>{u||(g=0,y=Date.now(),m())}}),d=document.getElementById("button-resume"),l=document.getElementById("menu"),d.onclick=()=>{u||(g=0,y=Date.now(),u=!0,m(),l.style.visibility="hidden")},addEventListener("blur",(()=>{r.releaseAllkeys(),u=!1,l.style.visibility="visible"})),g=0,y=Date.now(),m()}})()})();