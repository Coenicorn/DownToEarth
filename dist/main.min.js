(()=>{"use strict";var t={582:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Player=e.Rock=e.GameObject=void 0;const i=s(652);class n{position;dimensions;velocity;acceleration;onground;maxSpeed;constructor(t,e,s){this.position=t,this.dimensions=e,this.velocity={x:0,y:0},this.acceleration={x:0,y:0},this.onground=!1,this.maxSpeed=s}update(){this.velocity.x+=this.acceleration.x,this.velocity.y+=this.acceleration.y,this.velocity.x>this.maxSpeed&&(this.velocity.x=this.maxSpeed),this.velocity.x<-this.maxSpeed&&(this.velocity.x=-this.maxSpeed),this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,0==this.acceleration.x&&(this.velocity.x*=.9),0==this.acceleration.y&&(this.velocity.y*=.9),this.acceleration={x:0,y:0},this.onground=!1}collideLevel(t){let e=[];e.push(t.getChunkAt(this.position.x)),e.push(t.getChunkAt(this.position.x+this.dimensions.x)),e.forEach((t=>{t?.mesh.forEach((t=>{for(;(0,i.intersectsAABBLine)(t,this);)this.velocity.y=0,this.position.y-=1,this.onground=!0}))}))}}e.GameObject=n,e.Rock=class extends n{constructor(t,e){super(t,e,10)}render(t){t.translate(this.position),t.color("magenta"),t.drawRectangle(this.position.x,this.position.y,this.dimensions.x,this.dimensions.y),t.translate({x:0,y:0})}tick(){}},e.Player=class extends n{alive;speed;constructor(t,e){super(t,e,10),this.alive=!0,this.speed=2}tick(){}render(t){t.translateToScreenCoordinates({x:t.center.x,y:t.center.y}),t.color("red"),t.drawRectangle(0,0,this.dimensions.x,this.dimensions.y),t.translate({x:0,y:0})}move(t){switch(t){case 0:this.acceleration.x=-this.speed;break;case 1:this.acceleration.x=this.speed;break;case 2:this.onground&&(this.acceleration.y=-15)}}}},18:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.EntityManager=void 0,e.EntityManager=class{entities;constructor(){this.entities=[]}newEntity(t){this.entities.includes(t)||this.entities.push(t)}removeEntity(t){this.entities.includes(t)&&this.entities.splice(this.entities.indexOf(t),1)}update(t){this.entities.forEach((e=>{e.onground||(e.acceleration.y+=.5),e.update(),e.collideLevel(t)}))}render(t){this.entities.forEach((e=>{e.render(t)}))}}},652:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.lineMeshFromPoints=e.intersectsAABBLine=e.intersectsAABB=e.Line=void 0;class s{a;b;surfaceNormal;constructor(t,e){this.a=t,this.b=e,this.surfaceNormal=this.getSurfaceNormal()}getSurfaceNormal(){let t={x:this.b.x-this.a.x,y:this.b.y-this.a.y},e=Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2));return t.x/=e,t.y/=e,{x:t.y,y:-t.x}}intersects(t){let e,s,i,n,o,h,r,a;e=this.a.x,s=this.a.y,i=this.b.x,n=this.b.y,o=t.a.x,h=t.a.y,r=t.b.x,a=t.b.y;let c=(e-i)*(h-a)-(s-n)*(o-r);if(0==c)return;let l=((e-o)*(h-a)-(s-h)*(o-r))/c,d=((e-o)*(s-n)-(s-h)*(e-i))/c;return l>=0&&l<=1&&d>=0&&d<=1?{x:e+l*(i-e),y:s+l*(n-s)}:void 0}}e.Line=s,e.intersectsAABB=function(t,e){let s,i,n,o;return s=t.position,i={x:t.position.x+t.dimensions.x,y:t.position.y+t.dimensions.y},n=e.position,o={x:e.position.x+e.dimensions.x,y:e.position.y+e.dimensions.y},!(s.x>o.x||i.x<n.x||s.y>o.y||i.y<n.y)},e.intersectsAABBLine=function(t,e){let i,n,o,h,r,a,c,l,d,x,f,y;return i=e.position.x,r=e.position.y,n=e.position.x+e.dimensions.x,a=e.position.y,o=e.position.x+e.dimensions.x,c=e.position.y+e.dimensions.y,h=e.position.x,l=e.position.y+e.dimensions.y,d=new s({x:i,y:r},{x:n,y:a}),x=new s({x:n,y:a},{x:o,y:c}),f=new s({x:o,y:c},{x:h,y:l}),y=new s({x:h,y:l},{x:i,y:r}),null!=t.intersects(d)||null!=t.intersects(x)||null!=t.intersects(f)||null!=t.intersects(y)},e.lineMeshFromPoints=function(t){let e=[];for(let i=1,n=t.length;i<n;i++){let n=t[i],o=t[i-1];e.push(new s({x:o.x,y:o.y},{x:n.x,y:n.y}))}return e}},717:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.InputHandler=void 0,e.InputHandler=class{keys;keyBinds;constructor(t){this.keys=[],this.keyBinds=t,addEventListener("keydown",this.keyPressed.bind(this)),addEventListener("keyup",this.keyReleased.bind(this))}keyPressed(t){this.keys.includes(t.key)||this.keys.push(t.key)}keyReleased(t){try{this.keys.splice(this.keys.indexOf(t.key),1)}catch(t){}}handleKeys(){for(let t of this.keys)try{this.keyBinds[t]()}catch(t){}}}},512:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Level=void 0;const i=s(652),n=s(419),o=s(423);class h{mesh;config;xPosition;renderer;constructor(t,e,s){this.xPosition=s,this.config=e,this.renderer=new n.Renderer(e.maxChunkSegments*e.segmentLength,e.maxLevelHeight+this.config.levelDownExtension,new n.Camera({x:0,y:0})),this.mesh=[],this.makeLayout(t)}makeLayout(t){let e=[];this.renderer.clear();for(let s=0,i=this.config.maxChunkSegments;s<=i;s++){let i,n,o,h;i=s*this.config.segmentLength+this.xPosition,o=t.noise2D(i/this.config.noiseSampleSize,0),h=0;for(let e=1;e<3;e++)o+=t.noise2D(i/this.config.noiseSampleSize*e,0)/Math.pow(2,e),h+=1/Math.pow(2,e);o/=1+h,o=o*this.config.maxLevelHeight/2,n=o,e.push({x:i,y:n})}e.push({x:this.xPosition+this.config.maxChunkSegments*this.config.segmentLength,y:this.config.levelDownExtension}),e.push({x:this.xPosition,y:this.config.levelDownExtension}),this.mesh=(0,i.lineMeshFromPoints)(e)}}e.Level=class{config;chunks;noiseInstance;renderer;constructor(t,e){this.config=t,this.chunks=[],this.noiseInstance=new o.default,this.renderer=e,this.generateChunks()}update(t){}generateChunks(){let t=-this.config.maxChunkSegments*this.config.segmentLength;for(;!(t>this.renderer.width+this.config.maxChunkSegments*this.config.segmentLength);)this.chunks.push(new h(this.noiseInstance,this.config,t)),t+=this.config.maxChunkSegments*this.config.segmentLength}renderLevel(){this.renderer.translate({x:0,y:0}),this.chunks.forEach((t=>{this.renderer.color("green"),this.renderer.fillLineMesh(t.mesh)}))}getChunkAt(t){let e=this;return 0==t&&(t+=1),function s(i,n,o){let h=Math.floor((n+o)/2),r=i[h];if(!r)return;let a=r.xPosition,c=r.xPosition+e.config.segmentLength*e.config.maxChunkSegments;return t>=a&&t<=c?r:t>a?s(i,h+1,o):s(i,n,h-1)}(this.chunks,0,this.chunks.length)}}},419:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Renderer=e.Camera=e.loadImages=void 0,e.loadImages=async function(t,e){let s={};for(let i=0,n=t.length;i<n;i++){let n=t[i],o=await new Promise((t=>{let s=new Image;s.src=`${e}/${n}.png`,s.onload=()=>t(s),s.onerror=()=>{throw new Error("Image not found")}}));s[n]=o}return s},e.Camera=class{position;constructor(t){this.position=t}moveTo(t){this.position.x=-t.x,this.position.y=-t.y}},e.Renderer=class{canvas;context;width;height;offset;center;camera;constructor(t,e,s){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width=t,this.height=this.canvas.height=e,this.canvas.style.zIndex="-10",this.offset={x:0,y:0},this.center={x:this.width/2,y:this.height/2},this.camera=s}mount(t){let e=document.querySelector(t);if(!e)throw new Error("Error mounting Renderer to DOM element, wrong selector");e.appendChild(this.canvas)}clear(){this.context.clearRect(0,0,this.width,this.height)}color(t){this.context.fillStyle=t}drawRectangle(t,e,s,i){t=Math.round(t+this.offset.x),e=Math.round(e+this.offset.y),this.context.fillRect(t,e,s,i)}drawLineMesh(t){this.context.lineWidth=1,this.context.beginPath();let e=t[0];this.context.moveTo(Math.round(e.a.x+this.offset.x),Math.round(e.a.y+this.offset.y)),this.context.lineTo(Math.round(e.b.x+this.offset.x),Math.round(e.b.y+this.offset.y));for(let e=1,s=t.length;e<s;e++){let s=t[e];this.context.lineTo(Math.round(s.b.x+this.offset.x),Math.round(s.b.y+this.offset.y))}this.context.closePath(),this.context.stroke()}fillLineMesh(t){this.context.beginPath();let e=t[0];this.context.moveTo(Math.round(e.a.x+this.offset.x),Math.round(e.a.y+this.offset.y)),this.context.lineTo(Math.round(e.b.x+this.offset.x),Math.round(e.b.y+this.offset.y));for(let e=1,s=t.length;e<s;e++){let s=t[e];this.context.lineTo(Math.round(s.b.x+this.offset.x),Math.round(s.b.y+this.offset.y))}this.context.closePath(),this.context.fill()}drawSprite(t,e,s,i=t.width,n=t.height){e=Math.round(e+this.offset.x),s=Math.round(s+this.offset.y),this.context.drawImage(t,e,s,i,n)}drawLine(t,e,s,i,n){t=Math.round(t+this.offset.x),e=Math.round(e+this.offset.y),s=Math.round(s+this.offset.x),i=Math.round(i+this.offset.y),this.context.lineWidth=n,this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(s,i),this.context.stroke(),this.context.closePath()}drawShape(t){let e=t[0];this.context.lineWidth=1,this.context.beginPath(),this.context.moveTo(Math.round(e.x+this.offset.x),Math.round(e.y+this.offset.y));for(let e=1,s=t.length;e<s;e++){let s=t[e];this.context.lineTo(Math.round(s.x+this.offset.x),Math.round(s.y+this.offset.y))}this.context.closePath(),this.context.stroke()}fillShape(t){let e=t[0];this.context.beginPath(),this.context.moveTo(Math.round(e.x+this.offset.x),Math.round(e.y+this.offset.y));for(let e=1,s=t.length;e<s;e++){let s=t[e];this.context.lineTo(Math.round(s.x+this.offset.x),Math.round(s.y+this.offset.y))}this.context.closePath(),this.context.fill()}translate(t){this.offset.x=t.x+this.camera.position.x+this.center.x,this.offset.y=t.y+this.camera.position.y+this.center.y}translateToScreenCoordinates(t){this.offset.x=t.x,this.offset.y=t.y}getCanvas(){return this.canvas}}},423:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.buildPermutationTable=e.SimplexNoise=void 0;const s=.5*(Math.sqrt(3)-1),i=(3-Math.sqrt(3))/6,n=1/6,o=(Math.sqrt(5)-1)/4,h=(5-Math.sqrt(5))/20,r=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),a=new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]);class c{p;perm;permMod12;constructor(t=Math.random){const e="function"==typeof t?t:function(t){let e=0,s=0,i=0,n=1;const o=function(){let t=4022871197;return function(e){e=e.toString();for(let s=0;s<e.length;s++){t+=e.charCodeAt(s);let i=.02519603282416938*t;t=i>>>0,i-=t,i*=t,t=i>>>0,i-=t,t+=4294967296*i}return 2.3283064365386963e-10*(t>>>0)}}();return e=o(" "),s=o(" "),i=o(" "),e-=o(t),e<0&&(e+=1),s-=o(t),s<0&&(s+=1),i-=o(t),i<0&&(i+=1),function(){const t=2091639*e+2.3283064365386963e-10*n;return e=s,s=i,i=t-(n=0|t)}}(t);this.p=l(e),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(let t=0;t<512;t++)this.perm[t]=this.p[255&t],this.permMod12[t]=this.perm[t]%12}noise2D(t,e){const n=this.permMod12,o=this.perm;let h=0,a=0,c=0;const l=(t+e)*s,d=Math.floor(t+l),x=Math.floor(e+l),f=(d+x)*i,y=t-(d-f),u=e-(x-f);let m,g;y>u?(m=1,g=0):(m=0,g=1);const p=y-m+i,v=u-g+i,M=y-1+2*i,w=u-1+2*i,k=255&d,b=255&x;let P=.5-y*y-u*u;if(P>=0){const t=3*n[k+o[b]];P*=P,h=P*P*(r[t]*y+r[t+1]*u)}let S=.5-p*p-v*v;if(S>=0){const t=3*n[k+m+o[b+g]];S*=S,a=S*S*(r[t]*p+r[t+1]*v)}let L=.5-M*M-w*w;if(L>=0){const t=3*n[k+1+o[b+1]];L*=L,c=L*L*(r[t]*M+r[t+1]*w)}return 70*(h+a+c)}noise3D(t,e,s){const i=this.permMod12,o=this.perm;let h,a,c,l;const d=.3333333333333333*(t+e+s),x=Math.floor(t+d),f=Math.floor(e+d),y=Math.floor(s+d),u=(x+f+y)*n,m=t-(x-u),g=e-(f-u),p=s-(y-u);let v,M,w,k,b,P;m>=g?g>=p?(v=1,M=0,w=0,k=1,b=1,P=0):m>=p?(v=1,M=0,w=0,k=1,b=0,P=1):(v=0,M=0,w=1,k=1,b=0,P=1):g<p?(v=0,M=0,w=1,k=0,b=1,P=1):m<p?(v=0,M=1,w=0,k=0,b=1,P=1):(v=0,M=1,w=0,k=1,b=1,P=0);const S=m-v+n,L=g-M+n,C=p-w+n,E=m-k+2*n,A=g-b+2*n,T=p-P+2*n,B=m-1+.5,R=g-1+.5,_=p-1+.5,D=255&x,I=255&f,O=255&y;let j=.6-m*m-g*g-p*p;if(j<0)h=0;else{const t=3*i[D+o[I+o[O]]];j*=j,h=j*j*(r[t]*m+r[t+1]*g+r[t+2]*p)}let q=.6-S*S-L*L-C*C;if(q<0)a=0;else{const t=3*i[D+v+o[I+M+o[O+w]]];q*=q,a=q*q*(r[t]*S+r[t+1]*L+r[t+2]*C)}let H=.6-E*E-A*A-T*T;if(H<0)c=0;else{const t=3*i[D+k+o[I+b+o[O+P]]];H*=H,c=H*H*(r[t]*E+r[t+1]*A+r[t+2]*T)}let F=.6-B*B-R*R-_*_;if(F<0)l=0;else{const t=3*i[D+1+o[I+1+o[O+1]]];F*=F,l=F*F*(r[t]*B+r[t+1]*R+r[t+2]*_)}return 32*(h+a+c+l)}noise4D(t,e,s,i){const n=this.perm;let r,c,l,d,x;const f=(t+e+s+i)*o,y=Math.floor(t+f),u=Math.floor(e+f),m=Math.floor(s+f),g=Math.floor(i+f),p=(y+u+m+g)*h,v=t-(y-p),M=e-(u-p),w=s-(m-p),k=i-(g-p);let b=0,P=0,S=0,L=0;v>M?b++:P++,v>w?b++:S++,v>k?b++:L++,M>w?P++:S++,M>k?P++:L++,w>k?S++:L++;const C=b>=3?1:0,E=P>=3?1:0,A=S>=3?1:0,T=L>=3?1:0,B=b>=2?1:0,R=P>=2?1:0,_=S>=2?1:0,D=L>=2?1:0,I=b>=1?1:0,O=P>=1?1:0,j=S>=1?1:0,q=L>=1?1:0,H=v-C+h,F=M-E+h,N=w-A+h,z=k-T+h,W=v-B+2*h,U=M-R+2*h,G=w-_+2*h,K=k-D+2*h,$=v-I+3*h,J=M-O+3*h,Q=w-j+3*h,V=k-q+3*h,X=v-1+4*h,Y=M-1+4*h,Z=w-1+4*h,tt=k-1+4*h,et=255&y,st=255&u,it=255&m,nt=255&g;let ot=.6-v*v-M*M-w*w-k*k;if(ot<0)r=0;else{const t=n[et+n[st+n[it+n[nt]]]]%32*4;ot*=ot,r=ot*ot*(a[t]*v+a[t+1]*M+a[t+2]*w+a[t+3]*k)}let ht=.6-H*H-F*F-N*N-z*z;if(ht<0)c=0;else{const t=n[et+C+n[st+E+n[it+A+n[nt+T]]]]%32*4;ht*=ht,c=ht*ht*(a[t]*H+a[t+1]*F+a[t+2]*N+a[t+3]*z)}let rt=.6-W*W-U*U-G*G-K*K;if(rt<0)l=0;else{const t=n[et+B+n[st+R+n[it+_+n[nt+D]]]]%32*4;rt*=rt,l=rt*rt*(a[t]*W+a[t+1]*U+a[t+2]*G+a[t+3]*K)}let at=.6-$*$-J*J-Q*Q-V*V;if(at<0)d=0;else{const t=n[et+I+n[st+O+n[it+j+n[nt+q]]]]%32*4;at*=at,d=at*at*(a[t]*$+a[t+1]*J+a[t+2]*Q+a[t+3]*V)}let ct=.6-X*X-Y*Y-Z*Z-tt*tt;if(ct<0)x=0;else{const t=n[et+1+n[st+1+n[it+1+n[nt+1]]]]%32*4;ct*=ct,x=ct*ct*(a[t]*X+a[t+1]*Y+a[t+2]*Z+a[t+3]*tt)}return 27*(r+c+l+d+x)}}function l(t){const e=new Uint8Array(256);for(let t=0;t<256;t++)e[t]=t;for(let s=0;s<255;s++){const i=s+~~(t()*(256-s)),n=e[s];e[s]=e[i],e[i]=n}return e}e.SimplexNoise=c,e.default=c,e.buildPermutationTable=l}},e={};function s(i){var n=e[i];if(void 0!==n)return n.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,s),o.exports}(()=>{const t=s(419),e=s(717),i=s(18),n=s(582),o=s(512);let h,r,a,c,l,d,x,f;function y(){let t=Date.now(),e=t-f;for(f=t;e>=0;)a.handleKeys(),c.update(x),h.moveTo(l.position),e-=16.666666666666668;r.clear(),r.translateToScreenCoordinates({x:0,y:0}),r.drawSprite(d.Background1,0,0,r.width,r.height),x.renderLevel(),c.render(r),requestAnimationFrame(y)}onload=async function(){d=await(0,t.loadImages)(["Background1"],"./src/assets"),h=new t.Camera({x:0,y:0}),r=new t.Renderer(innerWidth,innerHeight,h),r.mount("#main"),c=new i.EntityManager,l=new n.Player({x:0,y:-300},{x:50,y:100}),c.newEntity(l),a=new e.InputHandler({a:()=>l.move(0),d:()=>l.move(1)," ":()=>l.move(2)}),x=new o.Level({segmentLength:10,maxLevelHeight:500,noiseSampleSize:1e3,renderDistance:500,maxChunkSegments:50,levelDownExtension:1500},r),f=Date.now(),y()}})()})();