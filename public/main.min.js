/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/canvas.ts":
/*!***********************!*\
  !*** ./src/canvas.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"canvas\": () => (/* binding */ canvas),\n/* harmony export */   \"context\": () => (/* binding */ context)\n/* harmony export */ });\nconst canvas = document.createElement(\"canvas\");\nconst context = canvas.getContext(\"2d\");\nconst width = innerWidth;\nconst height = innerHeight;\ncanvas.width = width;\ncanvas.height = height;\ndocument.body.appendChild(canvas);\n\n\n//# sourceURL=webpack://down_to_earth/./src/canvas.ts?");

/***/ }),

/***/ "./src/ecs/components.ts":
/*!*******************************!*\
  !*** ./src/ecs/components.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"BoxCollider\": () => (/* binding */ BoxCollider),\n/* harmony export */   \"BoxRendererComponent\": () => (/* binding */ BoxRendererComponent),\n/* harmony export */   \"CameraFollow\": () => (/* binding */ CameraFollow),\n/* harmony export */   \"ControllerComponent\": () => (/* binding */ ControllerComponent),\n/* harmony export */   \"PlayerComponent\": () => (/* binding */ PlayerComponent),\n/* harmony export */   \"Renderable\": () => (/* binding */ Renderable),\n/* harmony export */   \"SpriteComponent\": () => (/* binding */ SpriteComponent)\n/* harmony export */ });\n/* harmony import */ var _lib_ECS__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/ECS */ \"./src/lib/ECS.ts\");\n\nclass CameraFollow extends _lib_ECS__WEBPACK_IMPORTED_MODULE_0__.Component {\n}\nclass Renderable extends _lib_ECS__WEBPACK_IMPORTED_MODULE_0__.Component {\n    anchor;\n    constructor(anchor) {\n        super();\n        this.anchor = anchor;\n    }\n}\nclass SpriteComponent extends Renderable {\n    image;\n    scale;\n    constructor(image, scale, anchor) {\n        super(anchor);\n        this.image = image;\n        this.scale = scale;\n    }\n}\nclass ControllerComponent extends _lib_ECS__WEBPACK_IMPORTED_MODULE_0__.Component {\n    speed;\n    maxSpeed;\n    jumpHeight;\n    constructor(speed, maxSpeed, jumpHeight) {\n        super();\n        this.speed = speed;\n        this.maxSpeed = maxSpeed;\n        this.jumpHeight = jumpHeight;\n    }\n}\nclass BoxCollider extends _lib_ECS__WEBPACK_IMPORTED_MODULE_0__.Component {\n    width;\n    height;\n    isStatic;\n    collidingWith = [];\n    nextPos = null;\n    constructor(width, height, isStatic) {\n        super();\n        this.width = width;\n        this.height = height;\n        this.isStatic = isStatic;\n    }\n}\nclass BoxRendererComponent extends Renderable {\n    width;\n    height;\n    color;\n    constructor(width, height, color, anchor) {\n        super(anchor);\n        this.width = width;\n        this.height = height;\n        this.color = color;\n    }\n}\nclass PlayerComponent extends _lib_ECS__WEBPACK_IMPORTED_MODULE_0__.Component {\n    constructor() { super(); }\n}\n\n\n//# sourceURL=webpack://down_to_earth/./src/ecs/components.ts?");

/***/ }),

/***/ "./src/ecs/systems.ts":
/*!****************************!*\
  !*** ./src/ecs/systems.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"BoxRenderer\": () => (/* binding */ BoxRenderer),\n/* harmony export */   \"SpriteRenderer\": () => (/* binding */ SpriteRenderer),\n/* harmony export */   \"TrackCamera\": () => (/* binding */ TrackCamera)\n/* harmony export */ });\n/* harmony import */ var _canvas__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../canvas */ \"./src/canvas.ts\");\n/* harmony import */ var _main__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../main */ \"./src/main.ts\");\n/* harmony import */ var _components__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./components */ \"./src/ecs/components.ts\");\n/* harmony import */ var _lib_ECS__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../lib/ECS */ \"./src/lib/ECS.ts\");\n\n\n\n\nclass BoxRenderer extends _lib_ECS__WEBPACK_IMPORTED_MODULE_3__.System {\n    componentsRequired = new Set([_components__WEBPACK_IMPORTED_MODULE_2__.BoxRendererComponent]);\n    update(entities) {\n        for (let id of entities) {\n            let entity = _lib_ECS__WEBPACK_IMPORTED_MODULE_3__.ecs.getComponents(id);\n            let box = entity.get(_components__WEBPACK_IMPORTED_MODULE_2__.BoxRendererComponent);\n            _canvas__WEBPACK_IMPORTED_MODULE_0__.context.fillStyle = box.color;\n            _canvas__WEBPACK_IMPORTED_MODULE_0__.context.fillRect(entity.transform.position.x - _main__WEBPACK_IMPORTED_MODULE_1__.globalState.camera.position.x, entity.transform.position.y - _main__WEBPACK_IMPORTED_MODULE_1__.globalState.camera.position.y, box.width, box.height);\n        }\n    }\n}\nclass SpriteRenderer extends _lib_ECS__WEBPACK_IMPORTED_MODULE_3__.System {\n    componentsRequired = new Set([_components__WEBPACK_IMPORTED_MODULE_2__.SpriteComponent]);\n    update(entities) {\n        for (let id of entities.values()) {\n            let entity = _lib_ECS__WEBPACK_IMPORTED_MODULE_3__.ecs.getComponents(id);\n            let spritecomp = entity.get(_components__WEBPACK_IMPORTED_MODULE_2__.SpriteComponent);\n            let width = spritecomp.image.width * spritecomp.scale.x;\n            let height = spritecomp.image.height * spritecomp.scale.y;\n            _canvas__WEBPACK_IMPORTED_MODULE_0__.context.drawImage(spritecomp.image, entity.transform.position.x - spritecomp.anchor.x * width - _main__WEBPACK_IMPORTED_MODULE_1__.globalState.camera.position.x, entity.transform.position.y - spritecomp.anchor.y * height - _main__WEBPACK_IMPORTED_MODULE_1__.globalState.camera.position.y, width, height);\n        }\n    }\n}\nclass TrackCamera extends _lib_ECS__WEBPACK_IMPORTED_MODULE_3__.System {\n    componentsRequired = new Set([_components__WEBPACK_IMPORTED_MODULE_2__.CameraFollow]);\n    update(entities) {\n        for (let id of entities) {\n            let entity = _lib_ECS__WEBPACK_IMPORTED_MODULE_3__.ecs.getComponents(id);\n            _main__WEBPACK_IMPORTED_MODULE_1__.globalState.camera.position = entity.transform.position.clone();\n            _main__WEBPACK_IMPORTED_MODULE_1__.globalState.camera.position.x -= _canvas__WEBPACK_IMPORTED_MODULE_0__.canvas.width / 2;\n            _main__WEBPACK_IMPORTED_MODULE_1__.globalState.camera.position.y -= _canvas__WEBPACK_IMPORTED_MODULE_0__.canvas.height / 2;\n        }\n    }\n}\n\n\n//# sourceURL=webpack://down_to_earth/./src/ecs/systems.ts?");

/***/ }),

/***/ "./src/image.ts":
/*!**********************!*\
  !*** ./src/image.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"loadImage\": () => (/* binding */ loadImage),\n/* harmony export */   \"storedAssets\": () => (/* binding */ storedAssets)\n/* harmony export */ });\nfunction loadImage(src) {\n    return new Promise((resolve) => {\n        let t = new Image();\n        t.src = src;\n        t.onload = () => resolve(t);\n        t.onerror = () => { throw new Error(\"Image not found\"); };\n    });\n}\nconst storedAssets = {};\n\n\n//# sourceURL=webpack://down_to_earth/./src/image.ts?");

/***/ }),

/***/ "./src/input.ts":
/*!**********************!*\
  !*** ./src/input.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"Input\": () => (/* binding */ Input)\n/* harmony export */ });\nclass InputLocal {\n    keys = [];\n    mouseXPos = 0;\n    mouseYPos = 0;\n    constructor() {\n        addEventListener(\"keydown\", this.keyPress.bind(this));\n        addEventListener(\"keyup\", this.keyRelease.bind(this));\n        addEventListener(\"mousemove\", this.mouseMove.bind(this));\n    }\n    mouseMove(e) {\n        let x = e.clientX;\n        let y = e.clientY;\n        this.mouseXPos = x;\n        this.mouseYPos = y;\n    }\n    get mouseX() {\n        return this.mouseXPos;\n    }\n    get mouseY() {\n        return this.mouseYPos;\n    }\n    keyPress(event) {\n        let key = event.key;\n        if (!this.keys.includes(key))\n            this.keys.push(key);\n    }\n    keyRelease(event) {\n        let key = event.key;\n        if (this.keys.includes(key))\n            this.keys.splice(this.keys.indexOf(key), 1);\n    }\n    hasKey(key) {\n        return this.keys.includes(key);\n    }\n}\nconst Input = new InputLocal();\n\n\n//# sourceURL=webpack://down_to_earth/./src/input.ts?");

/***/ }),

/***/ "./src/lib/ECS.ts":
/*!************************!*\
  !*** ./src/lib/ECS.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"Component\": () => (/* binding */ Component),\n/* harmony export */   \"System\": () => (/* binding */ System),\n/* harmony export */   \"ecs\": () => (/* binding */ ecs)\n/* harmony export */ });\n/* harmony import */ var _vec2__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./vec2 */ \"./src/lib/vec2.ts\");\n\nclass Component {\n}\nclass Transform extends Component {\n    position;\n    constructor(position) {\n        super();\n        this.position = position;\n    }\n}\nclass System {\n    ecs;\n}\nclass ComponentContainer {\n    components = new Map();\n    transform = new Transform(new _vec2__WEBPACK_IMPORTED_MODULE_0__.Vec2(0, 0));\n    add(component) {\n        this.components.set(component.constructor, component);\n    }\n    get(component) {\n        return this.components.get(component);\n    }\n    remove(component) {\n        this.components.delete(component.constructor);\n    }\n    has(component) {\n        return this.components.has(component);\n    }\n    hasAll(componentClasses) {\n        for (let cls of componentClasses) {\n            if (!this.components.has(cls))\n                return false;\n        }\n        return true;\n    }\n}\nclass ecsLocal {\n    entities = new Map();\n    entitiesToRemove = [];\n    systems = new Map();\n    nextEntityId = 0;\n    newEntity() {\n        let e = this.nextEntityId;\n        this.nextEntityId++;\n        this.entities.set(e, new ComponentContainer());\n        return e;\n    }\n    removeEntity(entity) {\n        this.entitiesToRemove.push(entity);\n    }\n    addComponent(entity, component) {\n        this.entities.get(entity)?.add(component);\n        this.checkEntity(entity);\n    }\n    getComponents(entity) {\n        return this.entities.get(entity);\n    }\n    addSystem(system) {\n        system.ecs = this;\n        this.systems.set(system, new Set());\n        for (let entity of this.entities.keys()) {\n            this.checkES(entity, system);\n        }\n    }\n    checkEntity(entity) {\n        for (let system of this.systems.keys()) {\n            this.checkES(entity, system);\n        }\n    }\n    checkES(entity, system) {\n        let need = system.componentsRequired;\n        let have = this.entities.get(entity);\n        if (have?.hasAll(need)) {\n            this.systems.get(system)?.add(entity);\n        }\n        else {\n            this.systems.get(system)?.delete(entity);\n        }\n    }\n    destroyEntity(entity) {\n        this.entities.delete(entity);\n        for (let entities of this.systems.values()) {\n            entities.delete(entity);\n        }\n    }\n    update() {\n        for (let [system, entities] of this.systems.entries()) {\n            system.update(entities);\n        }\n        // remove entities\n        for (let i = 0; i < this.entitiesToRemove.length; i++) {\n            let e = this.entitiesToRemove.pop();\n            if (!e)\n                return;\n            this.destroyEntity(e);\n        }\n    }\n}\nconst ecs = new ecsLocal();\n\n\n//# sourceURL=webpack://down_to_earth/./src/lib/ECS.ts?");

/***/ }),

/***/ "./src/lib/physics.ecs.ts":
/*!********************************!*\
  !*** ./src/lib/physics.ecs.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"PhysicsComponent\": () => (/* binding */ PhysicsComponent),\n/* harmony export */   \"PhysicsController\": () => (/* binding */ PhysicsController)\n/* harmony export */ });\n/* harmony import */ var _ECS__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ECS */ \"./src/lib/ECS.ts\");\n/* harmony import */ var _quadTree__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./quadTree */ \"./src/lib/quadTree.ts\");\n/* harmony import */ var _vec2__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./vec2 */ \"./src/lib/vec2.ts\");\n\n\n\nclass PhysicsComponent extends _ECS__WEBPACK_IMPORTED_MODULE_0__.Component {\n    physics;\n    constructor(physics) {\n        super();\n        this.physics = physics;\n    }\n}\nclass PhysicsController extends _ECS__WEBPACK_IMPORTED_MODULE_0__.System {\n    componentsRequired = new Set([PhysicsComponent]);\n    quadTree;\n    constructor(dimensions) {\n        super();\n        this.quadTree = new _quadTree__WEBPACK_IMPORTED_MODULE_1__.QuadTree(dimensions, 0);\n    }\n    update(entities) {\n        this.quadTree.clear();\n        for (let id of entities) {\n            let entity = this.ecs.getComponents(id);\n            let physics = entity.get(PhysicsComponent).physics;\n            if (physics.hasGravity)\n                physics.applyForce(new _vec2__WEBPACK_IMPORTED_MODULE_2__.Vec2(0, 9.81));\n            physics.update();\n            physics.aabb.updatePos(physics.position);\n        }\n        // for (let id of entities) {\n        //     let entity = this.ecs.getComponents(id);\n        //     let physics = entity.get(PhysicsComponent).physics;\n        //     let others: PhysicsObject[] = [];\n        //     this.quadTree.retrieve(others, physics);\n        //     // console.log(quadTree.getIndex(physics));\n        // }\n    }\n}\n// export class CollisionManager extends System {\n//     componentsRequired: Set<Function> = new Set([BoxCollider]);\n//     update(entities: Set<number>): void {\n//         for (let i = 0; i < 3; i++) {\n//             for (let id of entities) {\n//                 let entity = ecs.getComponents(id);\n//                 let pos1 = entity.transform.position;\n//                 let box1 = entity.get(BoxCollider);\n//                 for (let entityCollidingId of entities) {\n//                     let entityColliding = ecs.getComponents(entityCollidingId);\n//                     if (entityColliding == entity) continue;\n//                     // aabb collision detection\n//                     let pos2 = entityColliding.transform.position;\n//                     let box2 = entityColliding.get(BoxCollider);\n//                     if (pos1.x + box1.width < pos2.x + .1 || pos2.x + box2.width < pos1.x + .1 || pos1.y + box1.height < pos2.y + .1 || pos2.y + box2.height < pos1.y + .1) continue;\n//                     box1.collidingWith.push(entityCollidingId);\n//                     box2.collidingWith.push(id);\n//                 }\n//             }\n//             for (let id of entities) {\n//                 let entity = ecs.getComponents(id);\n//                 let box = entity.get(BoxCollider);\n//                 if (box.isStatic) continue;\n//                 while (box.collidingWith.length > 0) {\n//                     // calculate the amount the two objects are intersecting\n//                     let entityCollidingId = box.collidingWith.pop()!, entityColliding = ecs.getComponents(entityCollidingId);\n//                     let box2 = entityColliding.get(BoxCollider);\n//                     let physics = entity.get(PhysicsComponent);\n//                     let physHis = entityColliding.get(PhysicsComponent);\n//                     let cX = (entity.transform.position.x + box.width / 2) - (entityColliding.transform.position.x + box2.width / 2);\n//                     let cY = (entity.transform.position.y + box.height / 2) - (entityColliding.transform.position.y + box2.height / 2);\n//                     let dX = (cX > 0);\n//                     let dY = (cY > 0);\n//                     cX = Math.abs(cX);\n//                     cY = Math.abs(cY);\n//                     cX = cX - box2.width / 2 - box.width / 2;\n//                     cY = cY - box2.height / 2 - box.height / 2;\n//                     let myMoveVec;\n//                     myMoveVec = new Vec2(cX, cY);\n//                     if (dX) myMoveVec.x *= -1;\n//                     if (dY) myMoveVec.y *= -1;\n//                     if (cX > cY) {\n//                         entity.transform.position.x += myMoveVec.x;\n//                         if (physics) {\n//                             physics.velocity.x = 0;\n//                         }\n//                     }\n//                     else {\n//                         entity.transform.position.y += myMoveVec.y;\n//                         if (physics) {\n//                             physics.velocity.y = 0;\n//                             if (!dY) physics.onground = true;\n//                         }\n//                     }\n//                 }\n//             }\n//         }\n//     }\n// }\n\n\n//# sourceURL=webpack://down_to_earth/./src/lib/physics.ecs.ts?");

/***/ }),

/***/ "./src/lib/physics.ts":
/*!****************************!*\
  !*** ./src/lib/physics.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"AABB\": () => (/* binding */ AABB),\n/* harmony export */   \"PhysicsObject\": () => (/* binding */ PhysicsObject)\n/* harmony export */ });\n/* harmony import */ var _vec2__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./vec2 */ \"./src/lib/vec2.ts\");\n\nclass AABB {\n    p1;\n    p2;\n    constructor(x, y, w, h) {\n        this.p1 = new _vec2__WEBPACK_IMPORTED_MODULE_0__.Vec2(x, y);\n        this.p2 = new _vec2__WEBPACK_IMPORTED_MODULE_0__.Vec2(x + w, y + h);\n    }\n    updatePos(pos) {\n        let w = this.width, h = this.height;\n        this.p1 = new _vec2__WEBPACK_IMPORTED_MODULE_0__.Vec2(pos.x, pos.y);\n        this.p2 = new _vec2__WEBPACK_IMPORTED_MODULE_0__.Vec2(pos.x + w, pos.y + h);\n    }\n    get x() {\n        return this.p1.x;\n    }\n    get y() {\n        return this.p1.y;\n    }\n    get width() {\n        return this.p2.x - this.p1.x;\n    }\n    get height() {\n        return this.p2.y - this.p1.y;\n    }\n}\n// export class Line {\n//     p1: Vec2;\n//     p2: Vec2;\n//     normal: Vec2;\n//     constructor(p1: Vec2, p2: Vec2) {\n//         this.p1 = p1;\n//         this.p2 = p2;\n//         let dX = this.p2.x - this.p1.x;\n//         let dY = this.p2.y - this.p1.y;\n//         this.normal = new Vec2(dY, -dX);\n//         this.normal.magnitude = 1;\n//     }\n//     getDistanceFromPoint(pt: Vec2): number {\n//         // define the x and y of point, the denominator and the numerator\n//         let x, y, d, n;\n//         x = pt.x;\n//         y = pt.y;\n//         // denominator is the length of this line\n//         d = Math.sqrt(Math.pow(this.p2.x - this.p1.x, 2) + Math.pow(this.p2.y - this.p1.y, 2));\n//         // numerator is the (absolute) area of the triangle defined by pt, this.p1 and this.p2\n//         n = Math.abs((this.p2.x - this.p1.x) * (this.p1.y - y) - (this.p1.x - x) * (this.p2.y - this.p1.y));\n//         return n / d;\n//     }\n//     isIntersecting(line: Line): boolean {\n//         let x1, x2, x3, x4, y1, y2, y3, y4, t, u, d;\n//         x1 = this.p1.x;\n//         x2 = this.p2.x;\n//         x3 = line.p1.x;\n//         x4 = line.p2.x;\n//         y1 = this.p1.y;\n//         y2 = this.p2.y;\n//         y3 = line.p1.y;\n//         y4 = line.p2.y;\n//         d = (x1 - x2) * (y3 - y4) - (y1 - y2) * (x3 - x4);\n//         t = ((x1 - x3) * (y3 - y4) - (y1 - y3) * (x3 - x4)) / d;\n//         u = ((x1 - x3) * (y1 - y2) - (y1 - y3) * (x1 - x2)) / d;\n//         return (t > 0 && t < 1 && u > 0 && u < 1);\n//     }\n// }\nclass PhysicsObject {\n    _position;\n    _velocity;\n    _acceleration;\n    _aabb;\n    _mass;\n    _hasGravity;\n    _isStatic;\n    constructor(_position, _velocity, _acceleration, _aabb, _mass, _hasGravity, _isStatic) {\n        this._position = _position;\n        this._velocity = _velocity;\n        this._acceleration = _acceleration;\n        this._aabb = _aabb;\n        this._mass = _mass;\n        this._hasGravity = _hasGravity;\n        this._isStatic = _isStatic;\n    }\n    get position() {\n        return this._position;\n    }\n    get velocity() {\n        return this._velocity;\n    }\n    get acceleration() {\n        return this._acceleration;\n    }\n    get hasGravity() {\n        return this._hasGravity;\n    }\n    get isStatic() {\n        return this._isStatic;\n    }\n    get mass() {\n        return this._mass;\n    }\n    get aabb() {\n        return this._aabb;\n    }\n    applyForce(force) {\n        force.divide(this.mass);\n        this.acceleration.add(force);\n    }\n    update() {\n        this._velocity.add(this.acceleration);\n        this._position.add(this.velocity);\n        this._acceleration = new _vec2__WEBPACK_IMPORTED_MODULE_0__.Vec2(0, 0);\n    }\n}\n\n\n//# sourceURL=webpack://down_to_earth/./src/lib/physics.ts?");

/***/ }),

/***/ "./src/lib/quadTree.ts":
/*!*****************************!*\
  !*** ./src/lib/quadTree.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"QuadTree\": () => (/* binding */ QuadTree)\n/* harmony export */ });\n/* harmony import */ var _physics__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./physics */ \"./src/lib/physics.ts\");\n\nclass QuadTree {\n    _max_objects = 5;\n    _max_level = 10;\n    _level;\n    _objects;\n    _bounds;\n    _nodes;\n    constructor(b, l) {\n        this._bounds = b;\n        this._level = l;\n        this._nodes = [];\n        this._objects = [];\n    }\n    clear() {\n        this._objects.splice(0, this._objects.length);\n        for (let i = 0, len = this._nodes.length; i < len; i++) {\n            this._nodes[i].clear();\n        }\n        this._nodes.splice(0, this._nodes.length);\n    }\n    split() {\n        let subWidth = Math.round(this._bounds.x / 2);\n        let subHeight = Math.round(this._bounds.y / 2);\n        let x = this._bounds.x;\n        let y = this._bounds.y;\n        this._nodes.push(new QuadTree(new _physics__WEBPACK_IMPORTED_MODULE_0__.AABB(x, y, subWidth, subHeight), this._level + 1));\n        this._nodes.push(new QuadTree(new _physics__WEBPACK_IMPORTED_MODULE_0__.AABB(x + subWidth, y, subWidth, subHeight), this._level + 1));\n        this._nodes.push(new QuadTree(new _physics__WEBPACK_IMPORTED_MODULE_0__.AABB(x + subWidth, y + subHeight, subWidth, subHeight), this._level + 1));\n        this._nodes.push(new QuadTree(new _physics__WEBPACK_IMPORTED_MODULE_0__.AABB(x, y + subHeight, subWidth, subHeight), this._level + 1));\n    }\n    getIndex(obj) {\n        let index = -1;\n        let centerX = this._bounds.width / 2;\n        let centerY = this._bounds.height / 2;\n        let bounds = obj.aabb;\n        let canFitLeft = (bounds.x < centerX && bounds.x + bounds.width < centerX);\n        let canFitRight = (bounds.x > centerX && bounds.x + bounds.width > centerX);\n        if (bounds.y < centerY && bounds.y + bounds.height < centerY) {\n            if (canFitLeft) {\n                index = 0;\n            }\n            else {\n                index = 1;\n            }\n        }\n        else {\n            if (canFitRight) {\n                index = 2;\n            }\n            else {\n                index = 3;\n            }\n        }\n        return index;\n    }\n    insert(obj) {\n        if (this._nodes[0]) {\n            let index = this.getIndex(obj);\n            if (index != -1) {\n                this._nodes[index].insert(obj);\n            }\n        }\n        this._objects.push(obj);\n        if (this._objects.length > this._max_objects && this._level < this._max_level) {\n            if (!this._nodes[0]) {\n                this.split();\n            }\n            let i = 0;\n            while (i < this._objects.length) {\n                let index = this.getIndex(this._objects[i]);\n                if (index != -1) {\n                    let objToPush = this._objects.splice(i, 1)[0];\n                    this._nodes[i].insert(objToPush);\n                }\n                else {\n                    i++;\n                }\n            }\n        }\n    }\n    retrieve(toPush, obj) {\n        let index = this.getIndex(obj);\n        if (index != -1 && this._nodes[0]) {\n            this._nodes[index].retrieve(toPush, obj);\n        }\n        toPush.concat(this._objects);\n        return toPush;\n    }\n}\n\n\n//# sourceURL=webpack://down_to_earth/./src/lib/quadTree.ts?");

/***/ }),

/***/ "./src/lib/vec2.ts":
/*!*************************!*\
  !*** ./src/lib/vec2.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"Vec2\": () => (/* binding */ Vec2)\n/* harmony export */ });\nclass Vec2 {\n    x;\n    y;\n    constructor(x, y) {\n        this.x = x;\n        this.y = y;\n    }\n    clone() {\n        return new Vec2(this.x, this.y);\n    }\n    get magnitude() {\n        return Math.sqrt(this.x * this.x + this.y * this.y);\n    }\n    set magnitude(val) {\n        let len = val / this.magnitude;\n        this.multiply(len);\n    }\n    add(val) {\n        if (typeof (val) == \"number\") {\n            this.x += val;\n            this.y += val;\n        }\n        else {\n            this.x += val.x;\n            this.y += val.y;\n        }\n    }\n    subtract(val) {\n        if (typeof (val) == \"number\") {\n            this.x -= val;\n            this.y -= val;\n        }\n        else {\n            this.x -= val.x;\n            this.y -= val.y;\n        }\n    }\n    divide(val) {\n        if (typeof (val) == \"number\") {\n            this.x /= val;\n            this.y /= val;\n        }\n        else {\n            this.x /= val.x;\n            this.y /= val.y;\n        }\n    }\n    multiply(val) {\n        if (typeof (val) == \"number\") {\n            this.x *= val;\n            this.y *= val;\n        }\n        else {\n            this.x *= val.x;\n            this.y *= val.y;\n        }\n    }\n}\n\n\n//# sourceURL=webpack://down_to_earth/./src/lib/vec2.ts?");

/***/ }),

/***/ "./src/main.ts":
/*!*********************!*\
  !*** ./src/main.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"globalState\": () => (/* binding */ globalState)\n/* harmony export */ });\n/* harmony import */ var _canvas__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./canvas */ \"./src/canvas.ts\");\n/* harmony import */ var _ecs_components__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ecs/components */ \"./src/ecs/components.ts\");\n/* harmony import */ var _lib_ECS__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./lib/ECS */ \"./src/lib/ECS.ts\");\n/* harmony import */ var _ecs_systems__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ecs/systems */ \"./src/ecs/systems.ts\");\n/* harmony import */ var _image__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./image */ \"./src/image.ts\");\n/* harmony import */ var _input__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./input */ \"./src/input.ts\");\n/* harmony import */ var _lib_vec2__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./lib/vec2 */ \"./src/lib/vec2.ts\");\n/* harmony import */ var _lib_physics_ecs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./lib/physics.ecs */ \"./src/lib/physics.ecs.ts\");\n/* harmony import */ var _lib_physics__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./lib/physics */ \"./src/lib/physics.ts\");\n\n\n\n\n\n\n\n\n\nconst storedAssets = {};\nconst globalState = {\n    Time: {\n        deltaTime: 0\n    },\n    camera: {\n        position: new _lib_vec2__WEBPACK_IMPORTED_MODULE_6__.Vec2(0, 0)\n    },\n    level: {\n        totalLevelHeight: 100000,\n        totalLevelWidth: _canvas__WEBPACK_IMPORTED_MODULE_0__.canvas.width * 2,\n        currentLevel: 1\n    }\n};\nlet border1;\nlet border2;\nlet player;\nlet level;\nlet last = 0, targetFps = 60, fps = 1000 / targetFps, timeElapsed = 0, framerateUpdate = 0;\nlet running = false;\nfunction renderGUI() {\n    // render height meter\n    _canvas__WEBPACK_IMPORTED_MODULE_0__.context.drawImage(storedAssets[\"depth_meter\"], 20, 20);\n    _canvas__WEBPACK_IMPORTED_MODULE_0__.context.fillStyle = \"black\";\n    let yPos = storedAssets[\"depth_meter\"].height / globalState.level.totalLevelHeight * _lib_ECS__WEBPACK_IMPORTED_MODULE_2__.ecs.getComponents(player).transform.position.y;\n    yPos = yPos < storedAssets[\"depth_meter\"].height ? yPos : storedAssets[\"depth_meter\"].height;\n    _canvas__WEBPACK_IMPORTED_MODULE_0__.context.fillRect(10, 20 + yPos, 50, 5);\n}\nfunction renderStaticContent() {\n    _canvas__WEBPACK_IMPORTED_MODULE_0__.context.drawImage(storedAssets[\"landscape\"], 0, 0, _canvas__WEBPACK_IMPORTED_MODULE_0__.canvas.width, _canvas__WEBPACK_IMPORTED_MODULE_0__.canvas.height);\n}\nfunction startGameLoop() {\n    let now = Date.now();\n    timeElapsed += (now - last);\n    globalState.Time.deltaTime = (now - last) / fps;\n    framerateUpdate += (now - last);\n    if (framerateUpdate > 500) {\n        document.getElementById(\"framerate\").innerHTML = (fps / (now - last) * targetFps).toString();\n        framerateUpdate = 0;\n    }\n    last = now;\n    // clear canvas\n    _canvas__WEBPACK_IMPORTED_MODULE_0__.context.clearRect(0, 0, _canvas__WEBPACK_IMPORTED_MODULE_0__.canvas.width, _canvas__WEBPACK_IMPORTED_MODULE_0__.canvas.height);\n    renderStaticContent();\n    _lib_ECS__WEBPACK_IMPORTED_MODULE_2__.ecs.update();\n    renderGUI();\n    if (_input__WEBPACK_IMPORTED_MODULE_5__.Input.hasKey(\"q\"))\n        running = false;\n    if (running)\n        requestAnimationFrame(startGameLoop);\n}\nasync function init() {\n    // asset initialization\n    storedAssets[\"player\"] = await (0,_image__WEBPACK_IMPORTED_MODULE_4__.loadImage)(\"./img/player.png\");\n    storedAssets[\"depth_meter\"] = await (0,_image__WEBPACK_IMPORTED_MODULE_4__.loadImage)(\"./img/depth_meter.png\");\n    storedAssets[\"landscape\"] = await (0,_image__WEBPACK_IMPORTED_MODULE_4__.loadImage)(\"./img/landscape.png\");\n    storedAssets[\"level1\"] = await (0,_image__WEBPACK_IMPORTED_MODULE_4__.loadImage)(\"./img/level1.png\");\n    // level = ecs.newEntity();\n    // ecs.addComponent(level, new BoxRendererComponent(globalState.level.totalLevelWidth, 100, \"red\", new Vec2(0, 0)))\n    // ecs.addComponent(level, new BoxCollider(globalState.level.totalLevelWidth, 100, true))\n    // ecs.addComponent(level, new SpriteComponent(storedAssets[\"level1\"], new Vec2(1, 1), new Vec2(0, .4)));\n    // ecs.addComponent(level, new PhysicsComponent(new PhysicsObject(ecs.getComponents(level).transform.position, new Vec2(0, 0), new Vec2(0, 0), new AABB(0, 0, globalState.level.totalLevelWidth, 100), 10, true, false)));\n    // ecs.getComponents(level).transform.position = new Vec2(0, canvas.height - 100);\n    // border1 = ecs.newEntity();\n    // ecs.addComponent(border1, new BoxCollider(1, globalState.level.totalLevelHeight, true));\n    // border2 = ecs.newEntity();\n    // ecs.addComponent(border2, new BoxCollider(1, globalState.level.totalLevelHeight, true));\n    // ecs.getComponents(border2).transform.position.x = globalState.level.totalLevelWidth;\n    player = _lib_ECS__WEBPACK_IMPORTED_MODULE_2__.ecs.newEntity();\n    _lib_ECS__WEBPACK_IMPORTED_MODULE_2__.ecs.addComponent(player, new _ecs_components__WEBPACK_IMPORTED_MODULE_1__.SpriteComponent(storedAssets[\"player\"], new _lib_vec2__WEBPACK_IMPORTED_MODULE_6__.Vec2(.2, .2), new _lib_vec2__WEBPACK_IMPORTED_MODULE_6__.Vec2(.25, .25)));\n    _lib_ECS__WEBPACK_IMPORTED_MODULE_2__.ecs.addComponent(player, new _ecs_components__WEBPACK_IMPORTED_MODULE_1__.ControllerComponent(1, 8, 6));\n    _lib_ECS__WEBPACK_IMPORTED_MODULE_2__.ecs.addComponent(player, new _ecs_components__WEBPACK_IMPORTED_MODULE_1__.BoxCollider(100, 100, false));\n    _lib_ECS__WEBPACK_IMPORTED_MODULE_2__.ecs.addComponent(player, new _ecs_components__WEBPACK_IMPORTED_MODULE_1__.PlayerComponent());\n    _lib_ECS__WEBPACK_IMPORTED_MODULE_2__.ecs.addComponent(player, new _ecs_components__WEBPACK_IMPORTED_MODULE_1__.CameraFollow());\n    _lib_ECS__WEBPACK_IMPORTED_MODULE_2__.ecs.addComponent(player, new _lib_physics_ecs__WEBPACK_IMPORTED_MODULE_7__.PhysicsComponent(new _lib_physics__WEBPACK_IMPORTED_MODULE_8__.PhysicsObject(_lib_ECS__WEBPACK_IMPORTED_MODULE_2__.ecs.getComponents(player).transform.position, new _lib_vec2__WEBPACK_IMPORTED_MODULE_6__.Vec2(0, 0), new _lib_vec2__WEBPACK_IMPORTED_MODULE_6__.Vec2(0, 0), new _lib_physics__WEBPACK_IMPORTED_MODULE_8__.AABB(0, 0, 100, 100), 10, false, false)));\n    for (let i = 0; i < 100; i++) {\n        let t = _lib_ECS__WEBPACK_IMPORTED_MODULE_2__.ecs.newEntity();\n        // ecs.getComponents(t).transform.position = new Vec2(Math.random() * canvas.width, Math.random() * canvas.height);\n        _lib_ECS__WEBPACK_IMPORTED_MODULE_2__.ecs.addComponent(t, new _ecs_components__WEBPACK_IMPORTED_MODULE_1__.BoxRendererComponent(10, 10, \"red\", new _lib_vec2__WEBPACK_IMPORTED_MODULE_6__.Vec2(0, 0)));\n        _lib_ECS__WEBPACK_IMPORTED_MODULE_2__.ecs.addComponent(t, new _lib_physics_ecs__WEBPACK_IMPORTED_MODULE_7__.PhysicsComponent(new _lib_physics__WEBPACK_IMPORTED_MODULE_8__.PhysicsObject(_lib_ECS__WEBPACK_IMPORTED_MODULE_2__.ecs.getComponents(t).transform.position, new _lib_vec2__WEBPACK_IMPORTED_MODULE_6__.Vec2(0, 0), new _lib_vec2__WEBPACK_IMPORTED_MODULE_6__.Vec2(0, 0), new _lib_physics__WEBPACK_IMPORTED_MODULE_8__.AABB(0, 0, 10, 10), 10, true, false)));\n    }\n    // // entity component system initialization\n    // ecs.addSystem(new CharacterController());\n    _lib_ECS__WEBPACK_IMPORTED_MODULE_2__.ecs.addSystem(new _lib_physics_ecs__WEBPACK_IMPORTED_MODULE_7__.PhysicsController(new _lib_physics__WEBPACK_IMPORTED_MODULE_8__.AABB(0, 0, globalState.level.totalLevelWidth + 1, globalState.level.totalLevelHeight + 1)));\n    _lib_ECS__WEBPACK_IMPORTED_MODULE_2__.ecs.addSystem(new _ecs_systems__WEBPACK_IMPORTED_MODULE_3__.TrackCamera());\n    _lib_ECS__WEBPACK_IMPORTED_MODULE_2__.ecs.addSystem(new _ecs_systems__WEBPACK_IMPORTED_MODULE_3__.BoxRenderer());\n    _lib_ECS__WEBPACK_IMPORTED_MODULE_2__.ecs.addSystem(new _ecs_systems__WEBPACK_IMPORTED_MODULE_3__.SpriteRenderer());\n    // starting the main game loop\n    last = Date.now();\n    running = true;\n    startGameLoop();\n}\nonload = init;\n\n\n//# sourceURL=webpack://down_to_earth/./src/main.ts?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module is referenced by other modules so it can't be inlined
/******/ 	var __webpack_exports__ = __webpack_require__("./src/main.ts");
/******/ 	
/******/ })()
;